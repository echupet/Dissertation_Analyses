---
title: "SCID_scoring"
author: "Elena Peterson"
date: "2024-04-07"
output: html_document
---

Script for summarizing SCID diagnoses

```{r}
library(dplyr)

scid = read.csv("../Data/SCID_Data/RRAY_SCIDScore_April+7,+2024_12.50_char_forR_cleaned.csv",stringsAsFactors = FALSE, header = TRUE)

```


```{r}
# trim subject IDs to match other formats
head(names(scid))
scid$participant = substr(scid$Subject.ID.,1,7)

# Start with S1 diagnoses
scid1 = scid[grep("S1",scid$Subject.ID),]

# select diagnosis columns- columns containing the words "current"/"past" and not containing "symptoms"
diag_cols = names(scid)[(grepl("CURRENT",names(scid)) | grepl("PAST",names(scid))) & !grepl("Symptoms",names(scid))]

scid1 = subset(scid1, select=c("participant", diag_cols))
dim(scid1) # 175

# convert NAs to 1's (should indicate absence of diagnosis)
scid1[is.na(scid1)] = 1
```



```{r}
# merge with n=157 dataset
dwide = read.csv("../Data/Merged_Data/Merged_Data_Wide_2024-04-16.csv",stringsAsFactors = FALSE, header = TRUE)
dim(dwide)
names(dwide)

# 2 more subjects to exclude
dwide2 = dwide[dwide$participant!="RRAY001" & dwide$participant!="RRAY146",]
dim(dwide2)

allscid = merge(dwide2, scid1, all.x = TRUE)
dim(allscid)
```

Start with S1 Data
```{r}

# function that finds current & past diagnoses and generates table of proportions
# x is name of diagnosis as written in scid file, without the CURRENT./PAST. prefix
scid_print = function(x) {
  cur = paste0("CURRENT.",x)
  past = paste0("PAST.",x)
  print(prop.table(table(allscid[cur])))
  print(sum(table(allscid[cur])))
  print(prop.table(table(allscid[past])))
  print(sum(table(allscid[past])))
}

# function that finds current & past diagnoses and generates table of number of subjects
# x is name of diagnosis as written in scid file, without the CURRENT./PAST. prefix
scid_print_num = function(x) {
  cur = paste0("CURRENT.",x)
  past = paste0("PAST.",x)
  print(table(allscid[cur]))
  print(sum(table(allscid[cur])))
  print(table(allscid[past]))
  print(sum(table(allscid[past])))
}

```


```{r}
# total should = 157 for each

# Mood disorders
scid_print("Major.Depressive.Disorder")
scid_print("Persistent.Depressive.Disorder")
scid_print("Bipolar.Disorder.I")
scid_print("Bipolar.Disorder.II")
scid_print("Bipolar.NOS")

# Anxiety disorders
scid_print("Agoraphobia") 
scid_print("Generalized.Anxiety.Disorder") 
scid_print("Panic.Disorder") 
scid_print("Social.Anxiety")

# Alcohol & Substance
scid_print("Alcohol.Use.Disorder")
scid_print("Alcohol.Severity")
scid_print("Substance.Use.Disorder")
scid_print("Substance.Severity")

# eating disorders
scid_print("Anorexia.Nervosa")
scid_print("Bulimia.Nervosa")
scid_print("Binge.Eating.Disorder")

# others
scid_print("ADHD")
scid_print("Obsessive.Compulsive.Disorder")
scid_print("PTSD")
```
